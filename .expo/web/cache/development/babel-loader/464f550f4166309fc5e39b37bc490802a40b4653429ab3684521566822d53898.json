{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { StatusBar } from 'expo-status-bar';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport * as WebBrowser from \"expo-web-browser\";\nimport * as Google from \"expo-auth-session/providers/google\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport React, { useEffect, useState } from 'react';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nWebBrowser.maybeCompleteAuthSession();\nexport default function App() {\n  var androidClientId = '187142393375-7bp1qk9479dibdaepdpj3ibeotm4pr3p.apps.googleusercontent.com';\n  var webClientId = '187142393375-c2ai5ek3ap50qat3i710ucc9mirv4j2b.apps.googleusercontent.com';\n  var _useState = useState(\"\"),\n    _useState2 = _slicedToArray(_useState, 2),\n    token = _useState2[0],\n    setToken = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    userInfo = _useState4[0],\n    setUserInfo = _useState4[1];\n  var _Google$useAuthReques = Google.useAuthRequest({\n      androidClientId: androidClientId,\n      webClientId: webClientId\n    }),\n    _Google$useAuthReques2 = _slicedToArray(_Google$useAuthReques, 3),\n    request = _Google$useAuthReques2[0],\n    response = _Google$useAuthReques2[1],\n    promptAsync = _Google$useAuthReques2[2];\n  useEffect(function () {\n    if ((response == null ? void 0 : response.type) === 'success') {\n      setToken(response.authentication.accessToken);\n      getUserInfo();\n    } else {\n      console.log(\"Chưa đăng nhập Google\");\n    }\n  });\n  var getUserInfo = function () {\n    var _ref = _asyncToGenerator(function* () {\n      try {\n        var _response = yield fetch(\"https://www.googleapis.com/userinfo/v2/me\", {\n          headers: {\n            Authorization: \"Bearer \" + token\n          }\n        });\n        var user = yield _response.json();\n        setUserInfo(user);\n      } catch (err) {}\n    });\n    return function getUserInfo() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return _jsx(View, {\n    style: styles.container,\n    children: userInfo === null ? _jsx(Button, {\n      title: \"\\u0110\\u0103ng nh\\u1EADp b\\u1EB1ng Google\",\n      disabled: !request,\n      onPress: function onPress() {\n        promptAsync();\n      }\n    }) : _jsx(Text, {\n      style: styles.text,\n      children: userInfo.name\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n});","map":{"version":3,"names":["StatusBar","Button","StyleSheet","Text","TouchableOpacity","View","WebBrowser","Google","AsyncStorage","React","useEffect","useState","jsx","_jsx","maybeCompleteAuthSession","App","androidClientId","webClientId","_useState","_useState2","_slicedToArray","token","setToken","_useState3","_useState4","userInfo","setUserInfo","_Google$useAuthReques","useAuthRequest","_Google$useAuthReques2","request","response","promptAsync","type","authentication","accessToken","getUserInfo","console","log","_ref","_asyncToGenerator","fetch","headers","Authorization","user","json","err","apply","arguments","style","styles","container","children","title","disabled","onPress","text","name","create","flex","backgroundColor","alignItems","justifyContent"],"sources":["E:/a2b-app/App.js"],"sourcesContent":["import { StatusBar } from 'expo-status-bar';\nimport { Button, StyleSheet, Text, TouchableOpacity, View } from 'react-native';\nimport * as WebBrowser from \"expo-web-browser\";\nimport * as Google from \"expo-auth-session/providers/google\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport React, { useEffect, useState } from 'react';\n\nWebBrowser.maybeCompleteAuthSession();\n\nexport default function App() {\n  const androidClientId = '187142393375-7bp1qk9479dibdaepdpj3ibeotm4pr3p.apps.googleusercontent.com';\n  const webClientId = '187142393375-c2ai5ek3ap50qat3i710ucc9mirv4j2b.apps.googleusercontent.com';\n  const [token, setToken] = useState(\"\");\n  const [userInfo, setUserInfo] = useState(null);\n  const [request, response, promptAsync] = Google.useAuthRequest({\n    androidClientId: androidClientId,\n    webClientId: webClientId\n  });\n  // mỗi lần render lại thì sẽ \n  useEffect(() => {\n    if(response?.type === 'success'){\n      setToken(response.authentication.accessToken);\n      getUserInfo();\n    }else{\n      console.log(\"Chưa đăng nhập Google\");\n    }\n  })\n  // React.useEffect(() => {\n  //   // handleSignInWithGoogle();\n\n  // }\n  // , [response])\n\n  // async function handleSignInWithGoogle(){\n  //   const user = await AsyncStorage.getItem(\"@user\"); // lay key user\n  //   if(!user){\n  //     // console.log(typeof user);\n  //     if(response?.type !== null){\n  //       if(response?.type === 'success'){ // toan tu ? tranh truong hop null hoac la undefinded\n  //         await getUserInfo(response.authentication.accessToken)\n  //       }else{\n  //         console.log('No response!');\n  //       }\n  //     }else{\n  //       console.log('No response!');\n  //     }\n  //   }else{\n  //     setUserInfo(JSON.parse(user))\n  //   }\n  // }\n\n  const getUserInfo = async () => {\n    try{\n      const response = await fetch(\"https://www.googleapis.com/userinfo/v2/me\",\n      {\n        headers:{ Authorization: `Bearer ${token}`},\n      });\n      const user = await response.json();\n      // await AsyncStorage.setItem('@user', JSON.stringify(user));\n      setUserInfo(user);\n    }catch (err){\n\n    }\n  }\n\n  return (\n    // <View style={styles.container}>\n    //   <Text>{JSON.stringify(userInfo, null, 2)}</Text>\n    //   <TouchableOpacity>\n    //     <Button title='Đăng nhập bằng Google' onPress={promptAsync}></Button>\n    //   </TouchableOpacity>\n    //   <StatusBar style=\"auto\" />\n    // </View>\n    <View style={styles.container}>\n    {userInfo === null ? (\n      <Button\n        title=\"Đăng nhập bằng Google\"\n        disabled={!request}\n        onPress={() => {\n          promptAsync();\n        }}\n      />\n    ) : (\n      <Text style={styles.text}>{userInfo.name}</Text>\n    )}\n  </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n});\n"],"mappings":";;AAAA,SAASA,SAAS,QAAQ,iBAAiB;AAAC,OAAAC,MAAA;AAAA,OAAAC,UAAA;AAAA,OAAAC,IAAA;AAAA,OAAAC,gBAAA;AAAA,OAAAC,IAAA;AAE5C,OAAO,KAAKC,UAAU,MAAM,kBAAkB;AAC9C,OAAO,KAAKC,MAAM,MAAM,oCAAoC;AAC5D,OAAOC,YAAY,MAAM,2CAA2C;AACpE,OAAOC,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAEnDP,UAAU,CAACQ,wBAAwB,CAAC,CAAC;AAErC,eAAe,SAASC,GAAGA,CAAA,EAAG;EAC5B,IAAMC,eAAe,GAAG,0EAA0E;EAClG,IAAMC,WAAW,GAAG,0EAA0E;EAC9F,IAAAC,SAAA,GAA0BP,QAAQ,CAAC,EAAE,CAAC;IAAAQ,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAA/BG,KAAK,GAAAF,UAAA;IAAEG,QAAQ,GAAAH,UAAA;EACtB,IAAAI,UAAA,GAAgCZ,QAAQ,CAAC,IAAI,CAAC;IAAAa,UAAA,GAAAJ,cAAA,CAAAG,UAAA;IAAvCE,QAAQ,GAAAD,UAAA;IAAEE,WAAW,GAAAF,UAAA;EAC5B,IAAAG,qBAAA,GAAyCpB,MAAM,CAACqB,cAAc,CAAC;MAC7DZ,eAAe,EAAEA,eAAe;MAChCC,WAAW,EAAEA;IACf,CAAC,CAAC;IAAAY,sBAAA,GAAAT,cAAA,CAAAO,qBAAA;IAHKG,OAAO,GAAAD,sBAAA;IAAEE,QAAQ,GAAAF,sBAAA;IAAEG,WAAW,GAAAH,sBAAA;EAKrCnB,SAAS,CAAC,YAAM;IACd,IAAG,CAAAqB,QAAQ,oBAARA,QAAQ,CAAEE,IAAI,MAAK,SAAS,EAAC;MAC9BX,QAAQ,CAACS,QAAQ,CAACG,cAAc,CAACC,WAAW,CAAC;MAC7CC,WAAW,CAAC,CAAC;IACf,CAAC,MAAI;MACHC,OAAO,CAACC,GAAG,CAAC,uBAAuB,CAAC;IACtC;EACF,CAAC,CAAC;EAyBF,IAAMF,WAAW;IAAA,IAAAG,IAAA,GAAAC,iBAAA,CAAG,aAAY;MAC9B,IAAG;QACD,IAAMT,SAAQ,SAASU,KAAK,CAAC,2CAA2C,EACxE;UACEC,OAAO,EAAC;YAAEC,aAAa,cAAYtB;UAAO;QAC5C,CAAC,CAAC;QACF,IAAMuB,IAAI,SAASb,SAAQ,CAACc,IAAI,CAAC,CAAC;QAElCnB,WAAW,CAACkB,IAAI,CAAC;MACnB,CAAC,QAAOE,GAAG,EAAC,CAEZ;IACF,CAAC;IAAA,gBAZKV,WAAWA,CAAA;MAAA,OAAAG,IAAA,CAAAQ,KAAA,OAAAC,SAAA;IAAA;EAAA,GAYhB;EAED,OAQEnC,IAAA,CAACR,IAAI;IAAC4C,KAAK,EAAEC,MAAM,CAACC,SAAU;IAAAC,QAAA,EAC7B3B,QAAQ,KAAK,IAAI,GAChBZ,IAAA,CAACZ,MAAM;MACLoD,KAAK,EAAC,2CAAuB;MAC7BC,QAAQ,EAAE,CAACxB,OAAQ;MACnByB,OAAO,EAAE,SAAAA,QAAA,EAAM;QACbvB,WAAW,CAAC,CAAC;MACf;IAAE,CACH,CAAC,GAEFnB,IAAA,CAACV,IAAI;MAAC8C,KAAK,EAAEC,MAAM,CAACM,IAAK;MAAAJ,QAAA,EAAE3B,QAAQ,CAACgC;IAAI,CAAO;EAChD,CACG,CAAC;AAET;AAEA,IAAMP,MAAM,GAAGhD,UAAU,CAACwD,MAAM,CAAC;EAC/BP,SAAS,EAAE;IACTQ,IAAI,EAAE,CAAC;IACPC,eAAe,EAAE,MAAM;IACvBC,UAAU,EAAE,QAAQ;IACpBC,cAAc,EAAE;EAClB;AACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}